<!DOCTYPE html>
<html>
<head>
  <title>webpack-dev-server</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/webpack-dev-server";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>webpack-dev-server</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);
<span class="hljs-keyword">const</span> open = <span class="hljs-built_in">require</span>(<span class="hljs-string">"opn"</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">const</span> net = <span class="hljs-built_in">require</span>(<span class="hljs-string">"net"</span>);
<span class="hljs-keyword">const</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">"url"</span>);
<span class="hljs-keyword">const</span> portfinder = <span class="hljs-built_in">require</span>(<span class="hljs-string">"portfinder"</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Local version replaces global one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">try</span> {
	<span class="hljs-keyword">const</span> localWebpackDevServer = <span class="hljs-built_in">require</span>.resolve(path.join(process.cwd(), <span class="hljs-string">"node_modules"</span>, <span class="hljs-string">"webpack-dev-server"</span>, <span class="hljs-string">"bin"</span>, <span class="hljs-string">"webpack-dev-server.js"</span>));
	<span class="hljs-keyword">if</span>(__filename !== localWebpackDevServer) {
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(localWebpackDevServer);
	}
} <span class="hljs-keyword">catch</span>(e) {}

<span class="hljs-keyword">const</span> Server = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../lib/Server"</span>);
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack"</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">versionInfo</span>(<span class="hljs-params"></span>) </span>{
	<span class="hljs-keyword">return</span> <span class="hljs-string">`webpack-dev-server <span class="hljs-subst">${<span class="hljs-built_in">require</span>(<span class="hljs-string">"../package.json"</span>).version}</span>\n`</span> +
		<span class="hljs-string">`webpack <span class="hljs-subst">${<span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack/package.json"</span>).version}</span>`</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">colorInfo</span>(<span class="hljs-params">useColor, msg</span>) </span>{
	<span class="hljs-keyword">if</span>(useColor)
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Make text blue and bold, so it <em>pops</em></p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">return</span> <span class="hljs-string">`\u001b[1m\u001b[34m<span class="hljs-subst">${msg}</span>\u001b[39m\u001b[22m`</span>;
	<span class="hljs-keyword">return</span> msg;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">colorError</span>(<span class="hljs-params">useColor, msg</span>) </span>{
	<span class="hljs-keyword">if</span>(useColor)
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Make text red and bold, so it <em>pops</em></p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">return</span> <span class="hljs-string">`\u001b[1m\u001b[31m<span class="hljs-subst">${msg}</span>\u001b[39m\u001b[22m`</span>;
	<span class="hljs-keyword">return</span> msg;
}

<span class="hljs-keyword">const</span> yargs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"yargs"</span>)
	.usage(<span class="hljs-string">`<span class="hljs-subst">${versionInfo()
		}</span>\nUsage: http://webpack.github.io/docs/webpack-dev-server.html`</span>);

<span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack/bin/config-yargs"</span>)(yargs);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>It is important that this is done after the webpack yargs config,
so it overrides webpack's version info.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">yargs.version(versionInfo);

<span class="hljs-keyword">const</span> ADVANCED_GROUP = <span class="hljs-string">"Advanced options:"</span>;
<span class="hljs-keyword">const</span> DISPLAY_GROUP = <span class="hljs-string">"Stats options:"</span>;
<span class="hljs-keyword">const</span> SSL_GROUP = <span class="hljs-string">"SSL options:"</span>;
<span class="hljs-keyword">const</span> CONNECTION_GROUP = <span class="hljs-string">"Connection options:"</span>;
<span class="hljs-keyword">const</span> RESPONSE_GROUP = <span class="hljs-string">"Response options:"</span>;
<span class="hljs-keyword">const</span> BASIC_GROUP = <span class="hljs-string">"Basic options:"</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Taken out of yargs because we must know if
it wasn't given by the user, in which case
we should use portfinder.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">const</span> DEFAULT_PORT = <span class="hljs-number">8080</span>;

yargs.options({
	<span class="hljs-string">"lazy"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Lazy"</span>
	},
	<span class="hljs-string">"inline"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Inline mode (set to false to disable including client scripts like livereload)"</span>
	},
	<span class="hljs-string">"progress"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Print compilation progress in percentage"</span>,
		<span class="hljs-attr">group</span>: BASIC_GROUP
	},
	<span class="hljs-string">"hot-only"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Do not refresh page if HMR fails"</span>,
		<span class="hljs-attr">group</span>: ADVANCED_GROUP
	},
	<span class="hljs-string">"stdin"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"close when stdin ends"</span>
	},
	<span class="hljs-string">"open"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Open default browser"</span>
	},
	<span class="hljs-string">"color"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">alias</span>: <span class="hljs-string">"colors"</span>,
		<span class="hljs-attr">default</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supportsColor</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">"supports-color"</span>);
		},
		<span class="hljs-attr">group</span>: DISPLAY_GROUP,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Enables/Disables colors on the console"</span>
	},
	<span class="hljs-string">"info"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">group</span>: DISPLAY_GROUP,
		<span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Info"</span>
	},
	<span class="hljs-string">"quiet"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">group</span>: DISPLAY_GROUP,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Quiet"</span>
	},
	<span class="hljs-string">"client-log-level"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">group</span>: DISPLAY_GROUP,
		<span class="hljs-attr">default</span>: <span class="hljs-string">"info"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Log level in the browser (info, warning, error or none)"</span>
	},
	<span class="hljs-string">"https"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">group</span>: SSL_GROUP,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"HTTPS"</span>
	},
	<span class="hljs-string">"key"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Path to a SSL key."</span>,
		<span class="hljs-attr">group</span>: SSL_GROUP
	},
	<span class="hljs-string">"cert"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Path to a SSL certificate."</span>,
		<span class="hljs-attr">group</span>: SSL_GROUP
	},
	<span class="hljs-string">"cacert"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Path to a SSL CA certificate."</span>,
		<span class="hljs-attr">group</span>: SSL_GROUP
	},
	<span class="hljs-string">"pfx"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Path to a SSL pfx file."</span>,
		<span class="hljs-attr">group</span>: SSL_GROUP
	},
	<span class="hljs-string">"pfx-passphrase"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Passphrase for pfx file."</span>,
		<span class="hljs-attr">group</span>: SSL_GROUP
	},
	<span class="hljs-string">"content-base"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"A directory or URL to serve HTML content from."</span>,
		<span class="hljs-attr">group</span>: RESPONSE_GROUP
	},
	<span class="hljs-string">"watch-content-base"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Enable live-reloading of the content-base."</span>,
		<span class="hljs-attr">group</span>: RESPONSE_GROUP
	},
	<span class="hljs-string">"history-api-fallback"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Fallback to /index.html for Single Page Applications."</span>,
		<span class="hljs-attr">group</span>: RESPONSE_GROUP
	},
	<span class="hljs-string">"compress"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Enable gzip compression"</span>,
		<span class="hljs-attr">group</span>: RESPONSE_GROUP
	},
	<span class="hljs-string">"port"</span>: {
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"The port"</span>,
		<span class="hljs-attr">group</span>: CONNECTION_GROUP
	},
	<span class="hljs-string">"socket"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"String"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"Socket to listen"</span>,
		<span class="hljs-attr">group</span>: CONNECTION_GROUP
	},
	<span class="hljs-string">"public"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"The public hostname/ip address of the server"</span>,
		<span class="hljs-attr">group</span>: CONNECTION_GROUP
	},
	<span class="hljs-string">"host"</span>: {
		<span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
		<span class="hljs-attr">default</span>: <span class="hljs-string">"localhost"</span>,
		<span class="hljs-attr">describe</span>: <span class="hljs-string">"The hostname/ip address the server will bind to"</span>,
		<span class="hljs-attr">group</span>: CONNECTION_GROUP
	}
});

<span class="hljs-keyword">const</span> argv = yargs.argv;

<span class="hljs-keyword">const</span> wpOpt = <span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack/bin/convert-argv"</span>)(yargs, argv, {
	<span class="hljs-attr">outputFilename</span>: <span class="hljs-string">"/bundle.js"</span>
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processOptions</span>(<span class="hljs-params">wpOpt</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>process Promise</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> wpOpt.then === <span class="hljs-string">"function"</span>) {
		wpOpt.then(processOptions).catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
			<span class="hljs-built_in">console</span>.error(err.stack || err);
			process.exit(); <span class="hljs-comment">// eslint-disable-line</span>
		});
		<span class="hljs-keyword">return</span>;
	}

	<span class="hljs-keyword">const</span> firstWpOpt = <span class="hljs-built_in">Array</span>.isArray(wpOpt) ? wpOpt[<span class="hljs-number">0</span>] : wpOpt;

	<span class="hljs-keyword">const</span> options = wpOpt.devServer || firstWpOpt.devServer || {};

	<span class="hljs-keyword">if</span>(argv.host !== <span class="hljs-string">"localhost"</span> || !options.host)
		options.host = argv.host;

	<span class="hljs-keyword">if</span>(argv.public)
		options.public = argv.public;

	<span class="hljs-keyword">if</span>(argv.socket)
		options.socket = argv.socket;

	<span class="hljs-keyword">if</span>(!options.publicPath) {
		options.publicPath = firstWpOpt.output &amp;&amp; firstWpOpt.output.publicPath || <span class="hljs-string">""</span>;
		<span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/^(https?:)?\/\//</span>.test(options.publicPath) &amp;&amp; options.publicPath[<span class="hljs-number">0</span>] !== <span class="hljs-string">"/"</span>)
			options.publicPath = <span class="hljs-string">`/<span class="hljs-subst">${options.publicPath}</span>`</span>;
	}

	<span class="hljs-keyword">if</span>(!options.filename)
		options.filename = firstWpOpt.output &amp;&amp; firstWpOpt.output.filename;

	<span class="hljs-keyword">if</span>(!options.watchOptions)
		options.watchOptions = firstWpOpt.watchOptions;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"stdin"</span>]) {
		process.stdin.on(<span class="hljs-string">"end"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			process.exit(<span class="hljs-number">0</span>); <span class="hljs-comment">// eslint-disable-line no-process-exit</span>
		});
		process.stdin.resume();
	}

	<span class="hljs-keyword">if</span>(!options.hot)
		options.hot = argv[<span class="hljs-string">"hot"</span>];

	<span class="hljs-keyword">if</span>(!options.hotOnly)
		options.hotOnly = argv[<span class="hljs-string">"hot-only"</span>];

	<span class="hljs-keyword">if</span>(!options.clientLogLevel)
		options.clientLogLevel = argv[<span class="hljs-string">"client-log-level"</span>];

	<span class="hljs-keyword">if</span>(options.contentBase === <span class="hljs-literal">undefined</span>) {
		<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"content-base"</span>]) {
			options.contentBase = argv[<span class="hljs-string">"content-base"</span>];
			<span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^[0-9]$/</span>.test(options.contentBase))
				options.contentBase = +options.contentBase;
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/^(https?:)?\/\//</span>.test(options.contentBase))
				options.contentBase = path.resolve(options.contentBase);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>It is possible to disable the contentBase by using <code>--no-content-base</code>, which results in arg[&quot;content-base&quot;] = false</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"content-base"</span>] === <span class="hljs-literal">false</span>) {
			options.contentBase = <span class="hljs-literal">false</span>;
		}
	}

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"watch-content-base"</span>])
		options.watchContentBase = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(!options.stats) {
		options.stats = {
			<span class="hljs-attr">cached</span>: <span class="hljs-literal">false</span>,
			<span class="hljs-attr">cachedAssets</span>: <span class="hljs-literal">false</span>
		};
	}

	<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> options.stats === <span class="hljs-string">"object"</span> &amp;&amp; <span class="hljs-keyword">typeof</span> options.stats.colors === <span class="hljs-string">"undefined"</span>)
		options.stats.colors = argv.color;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"lazy"</span>])
		options.lazy = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(!argv[<span class="hljs-string">"info"</span>])
		options.noInfo = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"quiet"</span>])
		options.quiet = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"https"</span>])
		options.https = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"cert"</span>])
		options.cert = fs.readFileSync(path.resolve(argv[<span class="hljs-string">"cert"</span>]));

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"key"</span>])
		options.key = fs.readFileSync(path.resolve(argv[<span class="hljs-string">"key"</span>]));

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"cacert"</span>])
		options.ca = fs.readFileSync(path.resolve(argv[<span class="hljs-string">"cacert"</span>]));

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"pfx"</span>])
		options.pfx = fs.readFileSync(path.resolve(argv[<span class="hljs-string">"pfx"</span>]));

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"pfx-passphrase"</span>])
		options.pfxPassphrase = argv[<span class="hljs-string">"pfx-passphrase"</span>];

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"inline"</span>] === <span class="hljs-literal">false</span>)
		options.inline = <span class="hljs-literal">false</span>;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"history-api-fallback"</span>])
		options.historyApiFallback = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"compress"</span>])
		options.compress = <span class="hljs-literal">true</span>;

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"open"</span>])
		options.open = <span class="hljs-literal">true</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Kind of weird, but ensures prior behavior isn't broken in cases
that wouldn't throw errors. E.g. both argv.port and options.port
were specified, but since argv.port is 8080, options.port will be
tried first instead.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	options.port = argv.port === DEFAULT_PORT ? (options.port || argv.port) : (argv.port || options.port);
	<span class="hljs-keyword">if</span>(options.port) {
		startDevServer(wpOpt, options);
		<span class="hljs-keyword">return</span>;
	}

	portfinder.basePort = DEFAULT_PORT;
	portfinder.getPort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, port</span>) </span>{
		<span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;
		options.port = port;
		startDevServer(wpOpt, options);
	});
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startDevServer</span>(<span class="hljs-params">wpOpt, options</span>) </span>{
	<span class="hljs-keyword">const</span> protocol = options.https ? <span class="hljs-string">"https"</span> : <span class="hljs-string">"http"</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>the formatted domain (url without path) of the webpack server</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">const</span> domain = url.format({
		<span class="hljs-attr">protocol</span>: protocol,
		<span class="hljs-attr">hostname</span>: options.host,
		<span class="hljs-attr">port</span>: options.socket ? <span class="hljs-number">0</span> : options.port.toString()
	});

	<span class="hljs-keyword">if</span>(options.inline !== <span class="hljs-literal">false</span>) {
		<span class="hljs-keyword">const</span> devClient = [<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">"../client/"</span>)}</span>?<span class="hljs-subst">${options.public ? <span class="hljs-string">`<span class="hljs-subst">${protocol}</span>://<span class="hljs-subst">${options.public}</span>`</span> : domain}</span>`</span>];

		<span class="hljs-keyword">if</span>(options.hotOnly)
			devClient.push(<span class="hljs-string">"webpack/hot/only-dev-server"</span>);
		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(options.hot)
			devClient.push(<span class="hljs-string">"webpack/hot/dev-server"</span>);

		[].concat(wpOpt).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">wpOpt</span>) </span>{
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> wpOpt.entry === <span class="hljs-string">"object"</span> &amp;&amp; !<span class="hljs-built_in">Array</span>.isArray(wpOpt.entry)) {
				<span class="hljs-built_in">Object</span>.keys(wpOpt.entry).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
					wpOpt.entry[key] = devClient.concat(wpOpt.entry[key]);
				});
			} <span class="hljs-keyword">else</span> {
				wpOpt.entry = devClient.concat(wpOpt.entry);
			}
		});
	}

	<span class="hljs-keyword">let</span> compiler;
	<span class="hljs-keyword">try</span> {
		compiler = webpack(wpOpt);
	} <span class="hljs-keyword">catch</span>(e) {
		<span class="hljs-keyword">if</span>(e <span class="hljs-keyword">instanceof</span> webpack.WebpackOptionsValidationError) {
			<span class="hljs-built_in">console</span>.error(colorError(options.stats.colors, e.message));
			process.exit(<span class="hljs-number">1</span>); <span class="hljs-comment">// eslint-disable-line</span>
		}
		<span class="hljs-keyword">throw</span> e;
	}

	<span class="hljs-keyword">if</span>(argv[<span class="hljs-string">"progress"</span>]) {
		compiler.apply(<span class="hljs-keyword">new</span> webpack.ProgressPlugin({
			<span class="hljs-attr">profile</span>: argv[<span class="hljs-string">"profile"</span>]
		}));
	}

	<span class="hljs-keyword">const</span> uri = domain + (options.inline !== <span class="hljs-literal">false</span> || options.lazy === <span class="hljs-literal">true</span> ? <span class="hljs-string">"/"</span> : <span class="hljs-string">"/webpack-dev-server/"</span>);

	<span class="hljs-keyword">let</span> server;
	<span class="hljs-keyword">try</span> {
		server = <span class="hljs-keyword">new</span> Server(compiler, options);
	} <span class="hljs-keyword">catch</span>(e) {
		<span class="hljs-keyword">const</span> OptionsValidationError = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../lib/OptionsValidationError"</span>);
		<span class="hljs-keyword">if</span>(e <span class="hljs-keyword">instanceof</span> OptionsValidationError) {
			<span class="hljs-built_in">console</span>.error(colorError(options.stats.colors, e.message));
			process.exit(<span class="hljs-number">1</span>); <span class="hljs-comment">// eslint-disable-line</span>
		}
		<span class="hljs-keyword">throw</span> e;
	}

	<span class="hljs-keyword">if</span>(options.socket) {
		server.listeningApp.on(<span class="hljs-string">"error"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
			<span class="hljs-keyword">if</span>(e.code === <span class="hljs-string">"EADDRINUSE"</span>) {
				<span class="hljs-keyword">const</span> clientSocket = <span class="hljs-keyword">new</span> net.Socket();
				clientSocket.on(<span class="hljs-string">"error"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
					<span class="hljs-keyword">if</span>(e.code === <span class="hljs-string">"ECONNREFUSED"</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>No other server listening on this socket so it can be safely removed</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">						fs.unlinkSync(options.socket);
						server.listen(options.socket, options.host, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
							<span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;
						});
					}
				});
				clientSocket.connect({ <span class="hljs-attr">path</span>: options.socket }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"This socket is already used"</span>);
				});
			}
		});
		server.listen(options.socket, options.host, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
			<span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;
			<span class="hljs-keyword">const</span> READ_WRITE = <span class="hljs-number">438</span>; <span class="hljs-comment">// chmod 666 (rw rw rw)</span>
			fs.chmod(options.socket, READ_WRITE, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
				<span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;
				reportReadiness(uri, options);
			});
		});
	} <span class="hljs-keyword">else</span> {
		server.listen(options.port, options.host, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
			<span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;
			reportReadiness(uri, options);
		});
	}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reportReadiness</span>(<span class="hljs-params">uri, options</span>) </span>{
	<span class="hljs-keyword">const</span> useColor = argv.color;
	<span class="hljs-keyword">let</span> startSentence = <span class="hljs-string">`Project is running at <span class="hljs-subst">${colorInfo(useColor, uri)}</span>`</span>
	<span class="hljs-keyword">if</span>(options.socket) {
		startSentence = <span class="hljs-string">`Listening to socket at <span class="hljs-subst">${colorInfo(useColor, options.socket)}</span>`</span>;
	}
	<span class="hljs-built_in">console</span>.log((argv[<span class="hljs-string">"progress"</span>] ? <span class="hljs-string">"\n"</span> : <span class="hljs-string">""</span>) + startSentence);

	<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`webpack output is served from <span class="hljs-subst">${colorInfo(useColor, options.publicPath)}</span>`</span>);
	<span class="hljs-keyword">const</span> contentBase = <span class="hljs-built_in">Array</span>.isArray(options.contentBase) ? options.contentBase.join(<span class="hljs-string">", "</span>) : options.contentBase;
	<span class="hljs-keyword">if</span>(contentBase)
		<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Content not from webpack is served from <span class="hljs-subst">${colorInfo(useColor, contentBase)}</span>`</span>);
	<span class="hljs-keyword">if</span>(options.historyApiFallback)
		<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`404s will fallback to <span class="hljs-subst">${colorInfo(useColor, options.historyApiFallback.index || <span class="hljs-string">"/index.html"</span>)}</span>`</span>);
	<span class="hljs-keyword">if</span>(options.open)
		open(uri);
}

processOptions(wpOpt);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
