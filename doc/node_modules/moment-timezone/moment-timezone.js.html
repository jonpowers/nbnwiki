<!DOCTYPE html>
<html>
<head>
  <title>moment-timezone.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/moment-timezone/moment-timezone.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>moment-timezone.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<p>! moment-timezone.js
! version : 0.5.11
! Copyright (c) JS Foundation and other contributors
! license : MIT
! github.com/moment/moment-timezone</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">root, factory</span>) </span>{
<span class="hljs-meta">	"use strict"</span>;

	<span class="hljs-comment">/*global define*/</span>
	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
		define([<span class="hljs-string">'moment'</span>], factory);                 <span class="hljs-comment">// AMD</span>
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">module</span>.exports) {
		<span class="hljs-built_in">module</span>.exports = factory(<span class="hljs-built_in">require</span>(<span class="hljs-string">'moment'</span>)); <span class="hljs-comment">// Node</span>
	} <span class="hljs-keyword">else</span> {
		factory(root.moment);                        <span class="hljs-comment">// Browser</span>
	}
}(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">moment</span>) </span>{
<span class="hljs-meta">	"use strict"</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Do not load moment-timezone a second time.
if (moment.tz !== undefined) {
	logError('Moment Timezone ' + moment.tz.version + ' was already loaded ' + (moment.tz.dataVersion ? 'with data from ' : 'without any data') + moment.tz.dataVersion);
	return moment;
}</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-keyword">var</span> VERSION = <span class="hljs-string">"0.5.11"</span>,
		zones = {},
		links = {},
		names = {},
		guesses = {},
		cachedGuess,

		momentVersion = moment.version.split(<span class="hljs-string">'.'</span>),
		major = +momentVersion[<span class="hljs-number">0</span>],
		minor = +momentVersion[<span class="hljs-number">1</span>];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Moment.js version check</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span> (major &lt; <span class="hljs-number">2</span> || (major === <span class="hljs-number">2</span> &amp;&amp; minor &lt; <span class="hljs-number">6</span>)) {
		logError(<span class="hljs-string">'Moment Timezone requires Moment.js &gt;= 2.6.0. You are using Moment.js '</span> + moment.version + <span class="hljs-string">'. See momentjs.com'</span>);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>Unpacking</p>
<hr>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">charCodeToInt</span>(<span class="hljs-params">charCode</span>) </span>{
		<span class="hljs-keyword">if</span> (charCode &gt; <span class="hljs-number">96</span>) {
			<span class="hljs-keyword">return</span> charCode - <span class="hljs-number">87</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (charCode &gt; <span class="hljs-number">64</span>) {
			<span class="hljs-keyword">return</span> charCode - <span class="hljs-number">29</span>;
		}
		<span class="hljs-keyword">return</span> charCode - <span class="hljs-number">48</span>;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unpackBase60</span>(<span class="hljs-params">string</span>) </span>{
		<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>,
			parts = string.split(<span class="hljs-string">'.'</span>),
			whole = parts[<span class="hljs-number">0</span>],
			fractional = parts[<span class="hljs-number">1</span>] || <span class="hljs-string">''</span>,
			multiplier = <span class="hljs-number">1</span>,
			num,
			out = <span class="hljs-number">0</span>,
			sign = <span class="hljs-number">1</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>handle negative numbers</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">if</span> (string.charCodeAt(<span class="hljs-number">0</span>) === <span class="hljs-number">45</span>) {
			i = <span class="hljs-number">1</span>;
			sign = <span class="hljs-number">-1</span>;
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>handle digits before the decimal</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">for</span> (i; i &lt; whole.length; i++) {
			num = charCodeToInt(whole.charCodeAt(i));
			out = <span class="hljs-number">60</span> * out + num;
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>handle digits after the decimal</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; fractional.length; i++) {
			multiplier = multiplier / <span class="hljs-number">60</span>;
			num = charCodeToInt(fractional.charCodeAt(i));
			out += num * multiplier;
		}

		<span class="hljs-keyword">return</span> out * sign;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayToInt</span> (<span class="hljs-params">array</span>) </span>{
		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
			array[i] = unpackBase60(array[i]);
		}
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">intToUntil</span> (<span class="hljs-params">array, length</span>) </span>{
		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) {
			array[i] = <span class="hljs-built_in">Math</span>.round((array[i - <span class="hljs-number">1</span>] || <span class="hljs-number">0</span>) + (array[i] * <span class="hljs-number">60000</span>)); <span class="hljs-comment">// minutes to milliseconds</span>
		}

		array[length - <span class="hljs-number">1</span>] = <span class="hljs-literal">Infinity</span>;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapIndices</span> (<span class="hljs-params">source, indices</span>) </span>{
		<span class="hljs-keyword">var</span> out = [], i;

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; indices.length; i++) {
			out[i] = source[indices[i]];
		}

		<span class="hljs-keyword">return</span> out;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unpack</span> (<span class="hljs-params">string</span>) </span>{
		<span class="hljs-keyword">var</span> data = string.split(<span class="hljs-string">'|'</span>),
			offsets = data[<span class="hljs-number">2</span>].split(<span class="hljs-string">' '</span>),
			indices = data[<span class="hljs-number">3</span>].split(<span class="hljs-string">''</span>),
			untils  = data[<span class="hljs-number">4</span>].split(<span class="hljs-string">' '</span>);

		arrayToInt(offsets);
		arrayToInt(indices);
		arrayToInt(untils);

		intToUntil(untils, indices.length);

		<span class="hljs-keyword">return</span> {
			<span class="hljs-attr">name</span>       : data[<span class="hljs-number">0</span>],
			<span class="hljs-attr">abbrs</span>      : mapIndices(data[<span class="hljs-number">1</span>].split(<span class="hljs-string">' '</span>), indices),
			<span class="hljs-attr">offsets</span>    : mapIndices(offsets, indices),
			<span class="hljs-attr">untils</span>     : untils,
			<span class="hljs-attr">population</span> : data[<span class="hljs-number">5</span>] | <span class="hljs-number">0</span>
		};
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>Zone object</p>
<hr>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Zone</span> (<span class="hljs-params">packedString</span>) </span>{
		<span class="hljs-keyword">if</span> (packedString) {
			<span class="hljs-keyword">this</span>._set(unpack(packedString));
		}
	}

	Zone.prototype = {
		<span class="hljs-attr">_set</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">unpacked</span>) </span>{
			<span class="hljs-keyword">this</span>.name       = unpacked.name;
			<span class="hljs-keyword">this</span>.abbrs      = unpacked.abbrs;
			<span class="hljs-keyword">this</span>.untils     = unpacked.untils;
			<span class="hljs-keyword">this</span>.offsets    = unpacked.offsets;
			<span class="hljs-keyword">this</span>.population = unpacked.population;
		},

		<span class="hljs-attr">_index</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">timestamp</span>) </span>{
			<span class="hljs-keyword">var</span> target = +timestamp,
				untils = <span class="hljs-keyword">this</span>.untils,
				i;

			<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; untils.length; i++) {
				<span class="hljs-keyword">if</span> (target &lt; untils[i]) {
					<span class="hljs-keyword">return</span> i;
				}
			}
		},

		<span class="hljs-attr">parse</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">timestamp</span>) </span>{
			<span class="hljs-keyword">var</span> target  = +timestamp,
				offsets = <span class="hljs-keyword">this</span>.offsets,
				untils  = <span class="hljs-keyword">this</span>.untils,
				max     = untils.length - <span class="hljs-number">1</span>,
				offset, offsetNext, offsetPrev, i;

			<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; max; i++) {
				offset     = offsets[i];
				offsetNext = offsets[i + <span class="hljs-number">1</span>];
				offsetPrev = offsets[i ? i - <span class="hljs-number">1</span> : i];

				<span class="hljs-keyword">if</span> (offset &lt; offsetNext &amp;&amp; tz.moveAmbiguousForward) {
					offset = offsetNext;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (offset &gt; offsetPrev &amp;&amp; tz.moveInvalidForward) {
					offset = offsetPrev;
				}

				<span class="hljs-keyword">if</span> (target &lt; untils[i] - (offset * <span class="hljs-number">60000</span>)) {
					<span class="hljs-keyword">return</span> offsets[i];
				}
			}

			<span class="hljs-keyword">return</span> offsets[max];
		},

		<span class="hljs-attr">abbr</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mom</span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.abbrs[<span class="hljs-keyword">this</span>._index(mom)];
		},

		<span class="hljs-attr">offset</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mom</span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.offsets[<span class="hljs-keyword">this</span>._index(mom)];
		}
	};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>Current Timezone</p>
<hr>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OffsetAt</span>(<span class="hljs-params">at</span>) </span>{
		<span class="hljs-keyword">var</span> timeString = at.toTimeString();
		<span class="hljs-keyword">var</span> abbr = timeString.match(<span class="hljs-regexp">/\([a-z ]+\)/i</span>);
		<span class="hljs-keyword">if</span> (abbr &amp;&amp; abbr[<span class="hljs-number">0</span>]) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>17:56:31 GMT-0600 (CST)
17:56:31 GMT-0600 (Central Standard Time)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			abbr = abbr[<span class="hljs-number">0</span>].match(<span class="hljs-regexp">/[A-Z]/g</span>);
			abbr = abbr ? abbr.join(<span class="hljs-string">''</span>) : <span class="hljs-literal">undefined</span>;
		} <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>17:56:31 CST
17:56:31 GMT+0800 (台北標準時間)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			abbr = timeString.match(<span class="hljs-regexp">/[A-Z]{3,5}/g</span>);
			abbr = abbr ? abbr[<span class="hljs-number">0</span>] : <span class="hljs-literal">undefined</span>;
		}

		<span class="hljs-keyword">if</span> (abbr === <span class="hljs-string">'GMT'</span>) {
			abbr = <span class="hljs-literal">undefined</span>;
		}

		<span class="hljs-keyword">this</span>.at = +at;
		<span class="hljs-keyword">this</span>.abbr = abbr;
		<span class="hljs-keyword">this</span>.offset = at.getTimezoneOffset();
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ZoneScore</span>(<span class="hljs-params">zone</span>) </span>{
		<span class="hljs-keyword">this</span>.zone = zone;
		<span class="hljs-keyword">this</span>.offsetScore = <span class="hljs-number">0</span>;
		<span class="hljs-keyword">this</span>.abbrScore = <span class="hljs-number">0</span>;
	}

	ZoneScore.prototype.scoreOffsetAt = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">offsetAt</span>) </span>{
		<span class="hljs-keyword">this</span>.offsetScore += <span class="hljs-built_in">Math</span>.abs(<span class="hljs-keyword">this</span>.zone.offset(offsetAt.at) - offsetAt.offset);
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.zone.abbr(offsetAt.at).replace(<span class="hljs-regexp">/[^A-Z]/g</span>, <span class="hljs-string">''</span>) !== offsetAt.abbr) {
			<span class="hljs-keyword">this</span>.abbrScore++;
		}
	};

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findChange</span>(<span class="hljs-params">low, high</span>) </span>{
		<span class="hljs-keyword">var</span> mid, diff;

		<span class="hljs-keyword">while</span> ((diff = ((high.at - low.at) / <span class="hljs-number">12e4</span> | <span class="hljs-number">0</span>) * <span class="hljs-number">6e4</span>)) {
			mid = <span class="hljs-keyword">new</span> OffsetAt(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(low.at + diff));
			<span class="hljs-keyword">if</span> (mid.offset === low.offset) {
				low = mid;
			} <span class="hljs-keyword">else</span> {
				high = mid;
			}
		}

		<span class="hljs-keyword">return</span> low;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">userOffsets</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> startYear = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getFullYear() - <span class="hljs-number">2</span>,
			last = <span class="hljs-keyword">new</span> OffsetAt(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(startYear, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)),
			offsets = [last],
			change, next, i;

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">48</span>; i++) {
			next = <span class="hljs-keyword">new</span> OffsetAt(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(startYear, i, <span class="hljs-number">1</span>));
			<span class="hljs-keyword">if</span> (next.offset !== last.offset) {
				change = findChange(last, next);
				offsets.push(change);
				offsets.push(<span class="hljs-keyword">new</span> OffsetAt(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(change.at + <span class="hljs-number">6e4</span>)));
			}
			last = next;
		}

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
			offsets.push(<span class="hljs-keyword">new</span> OffsetAt(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(startYear + i, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)));
			offsets.push(<span class="hljs-keyword">new</span> OffsetAt(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(startYear + i, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>)));
		}

		<span class="hljs-keyword">return</span> offsets;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortZoneScores</span> (<span class="hljs-params">a, b</span>) </span>{
		<span class="hljs-keyword">if</span> (a.offsetScore !== b.offsetScore) {
			<span class="hljs-keyword">return</span> a.offsetScore - b.offsetScore;
		}
		<span class="hljs-keyword">if</span> (a.abbrScore !== b.abbrScore) {
			<span class="hljs-keyword">return</span> a.abbrScore - b.abbrScore;
		}
		<span class="hljs-keyword">return</span> b.zone.population - a.zone.population;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addToGuesses</span> (<span class="hljs-params">name, offsets</span>) </span>{
		<span class="hljs-keyword">var</span> i, offset;
		arrayToInt(offsets);
		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; offsets.length; i++) {
			offset = offsets[i];
			guesses[offset] = guesses[offset] || {};
			guesses[offset][name] = <span class="hljs-literal">true</span>;
		}
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">guessesForUserOffsets</span> (<span class="hljs-params">offsets</span>) </span>{
		<span class="hljs-keyword">var</span> offsetsLength = offsets.length,
			filteredGuesses = {},
			out = [],
			i, j, guessesOffset;

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; offsetsLength; i++) {
			guessesOffset = guesses[offsets[i].offset] || {};
			<span class="hljs-keyword">for</span> (j <span class="hljs-keyword">in</span> guessesOffset) {
				<span class="hljs-keyword">if</span> (guessesOffset.hasOwnProperty(j)) {
					filteredGuesses[j] = <span class="hljs-literal">true</span>;
				}
			}
		}

		<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> filteredGuesses) {
			<span class="hljs-keyword">if</span> (filteredGuesses.hasOwnProperty(i)) {
				out.push(names[i]);
			}
		}

		<span class="hljs-keyword">return</span> out;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rebuildGuess</span> (<span class="hljs-params"></span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>use Intl API when available and returning valid time zone</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">try</span> {
			<span class="hljs-keyword">var</span> intlName = <span class="hljs-built_in">Intl</span>.DateTimeFormat().resolvedOptions().timeZone;
			<span class="hljs-keyword">if</span> (intlName){
				<span class="hljs-keyword">var</span> name = names[normalizeName(intlName)];
				<span class="hljs-keyword">if</span> (name) {
					<span class="hljs-keyword">return</span> name;
				}
				logError(<span class="hljs-string">"Moment Timezone found "</span> + intlName + <span class="hljs-string">" from the Intl api, but did not have that data loaded."</span>);
			}
		} <span class="hljs-keyword">catch</span> (e) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>Intl unavailable, fall back to manual guessing.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		}

		<span class="hljs-keyword">var</span> offsets = userOffsets(),
			offsetsLength = offsets.length,
			guesses = guessesForUserOffsets(offsets),
			zoneScores = [],
			zoneScore, i, j;

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; guesses.length; i++) {
			zoneScore = <span class="hljs-keyword">new</span> ZoneScore(getZone(guesses[i]), offsetsLength);
			<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; offsetsLength; j++) {
				zoneScore.scoreOffsetAt(offsets[j]);
			}
			zoneScores.push(zoneScore);
		}

		zoneScores.sort(sortZoneScores);

		<span class="hljs-keyword">return</span> zoneScores.length &gt; <span class="hljs-number">0</span> ? zoneScores[<span class="hljs-number">0</span>].zone.name : <span class="hljs-literal">undefined</span>;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">guess</span> (<span class="hljs-params">ignoreCache</span>) </span>{
		<span class="hljs-keyword">if</span> (!cachedGuess || ignoreCache) {
			cachedGuess = rebuildGuess();
		}
		<span class="hljs-keyword">return</span> cachedGuess;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>Global Methods</p>
<hr>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeName</span> (<span class="hljs-params">name</span>) </span>{
		<span class="hljs-keyword">return</span> (name || <span class="hljs-string">''</span>).toLowerCase().replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">'_'</span>);
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addZone</span> (<span class="hljs-params">packed</span>) </span>{
		<span class="hljs-keyword">var</span> i, name, split, normalized;

		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> packed === <span class="hljs-string">"string"</span>) {
			packed = [packed];
		}

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; packed.length; i++) {
			split = packed[i].split(<span class="hljs-string">'|'</span>);
			name = split[<span class="hljs-number">0</span>];
			normalized = normalizeName(name);
			zones[normalized] = packed[i];
			names[normalized] = name;
			<span class="hljs-keyword">if</span> (split[<span class="hljs-number">5</span>]) {
				addToGuesses(normalized, split[<span class="hljs-number">2</span>].split(<span class="hljs-string">' '</span>));
			}
		}
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getZone</span> (<span class="hljs-params">name, caller</span>) </span>{
		name = normalizeName(name);

		<span class="hljs-keyword">var</span> zone = zones[name];
		<span class="hljs-keyword">var</span> link;

		<span class="hljs-keyword">if</span> (zone <span class="hljs-keyword">instanceof</span> Zone) {
			<span class="hljs-keyword">return</span> zone;
		}

		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> zone === <span class="hljs-string">'string'</span>) {
			zone = <span class="hljs-keyword">new</span> Zone(zone);
			zones[name] = zone;
			<span class="hljs-keyword">return</span> zone;
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Pass getZone to prevent recursion more than 1 level deep</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">if</span> (links[name] &amp;&amp; caller !== getZone &amp;&amp; (link = getZone(links[name], getZone))) {
			zone = zones[name] = <span class="hljs-keyword">new</span> Zone();
			zone._set(link);
			zone.name = names[name];
			<span class="hljs-keyword">return</span> zone;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNames</span> (<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> i, out = [];

		<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> names) {
			<span class="hljs-keyword">if</span> (names.hasOwnProperty(i) &amp;&amp; (zones[i] || zones[links[i]]) &amp;&amp; names[i]) {
				out.push(names[i]);
			}
		}

		<span class="hljs-keyword">return</span> out.sort();
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLink</span> (<span class="hljs-params">aliases</span>) </span>{
		<span class="hljs-keyword">var</span> i, alias, normal0, normal1;

		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> aliases === <span class="hljs-string">"string"</span>) {
			aliases = [aliases];
		}

		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; aliases.length; i++) {
			alias = aliases[i].split(<span class="hljs-string">'|'</span>);

			normal0 = normalizeName(alias[<span class="hljs-number">0</span>]);
			normal1 = normalizeName(alias[<span class="hljs-number">1</span>]);

			links[normal0] = normal1;
			names[normal0] = alias[<span class="hljs-number">0</span>];

			links[normal1] = normal0;
			names[normal1] = alias[<span class="hljs-number">1</span>];
		}
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadData</span> (<span class="hljs-params">data</span>) </span>{
		addZone(data.zones);
		addLink(data.links);
		tz.dataVersion = data.version;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">zoneExists</span> (<span class="hljs-params">name</span>) </span>{
		<span class="hljs-keyword">if</span> (!zoneExists.didShowError) {
			zoneExists.didShowError = <span class="hljs-literal">true</span>;
				logError(<span class="hljs-string">"moment.tz.zoneExists('"</span> + name + <span class="hljs-string">"') has been deprecated in favor of !moment.tz.zone('"</span> + name + <span class="hljs-string">"')"</span>);
		}
		<span class="hljs-keyword">return</span> !!getZone(name);
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">needsOffset</span> (<span class="hljs-params">m</span>) </span>{
		<span class="hljs-keyword">return</span> !!(m._a &amp;&amp; (m._tzm === <span class="hljs-literal">undefined</span>));
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logError</span> (<span class="hljs-params">message</span>) </span>{
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">console</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">console</span>.error === <span class="hljs-string">'function'</span>) {
			<span class="hljs-built_in">console</span>.error(message);
		}
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>moment.tz namespace</p>
<hr>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tz</span> (<span class="hljs-params">input</span>) </span>{
		<span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>),
			name = <span class="hljs-built_in">arguments</span>[<span class="hljs-built_in">arguments</span>.length - <span class="hljs-number">1</span>],
			zone = getZone(name),
			out  = moment.utc.apply(<span class="hljs-literal">null</span>, args);

		<span class="hljs-keyword">if</span> (zone &amp;&amp; !moment.isMoment(input) &amp;&amp; needsOffset(out)) {
			out.add(zone.parse(out), <span class="hljs-string">'minutes'</span>);
		}

		out.tz(name);

		<span class="hljs-keyword">return</span> out;
	}

	tz.version      = VERSION;
	tz.dataVersion  = <span class="hljs-string">''</span>;
	tz._zones       = zones;
	tz._links       = links;
	tz._names       = names;
	tz.add          = addZone;
	tz.link         = addLink;
	tz.load         = loadData;
	tz.zone         = getZone;
	tz.zoneExists   = zoneExists; <span class="hljs-comment">// deprecated in 0.1.0</span>
	tz.guess        = guess;
	tz.names        = getNames;
	tz.Zone         = Zone;
	tz.unpack       = unpack;
	tz.unpackBase60 = unpackBase60;
	tz.needsOffset  = needsOffset;
	tz.moveInvalidForward   = <span class="hljs-literal">true</span>;
	tz.moveAmbiguousForward = <span class="hljs-literal">false</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>Interface with Moment.js</p>
<hr>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-keyword">var</span> fn = moment.fn;

	moment.tz = tz;

	moment.defaultZone = <span class="hljs-literal">null</span>;

	moment.updateOffset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mom, keepTime</span>) </span>{
		<span class="hljs-keyword">var</span> zone = moment.defaultZone,
			offset;

		<span class="hljs-keyword">if</span> (mom._z === <span class="hljs-literal">undefined</span>) {
			<span class="hljs-keyword">if</span> (zone &amp;&amp; needsOffset(mom) &amp;&amp; !mom._isUTC) {
				mom._d = moment.utc(mom._a)._d;
				mom.utc().add(zone.parse(mom), <span class="hljs-string">'minutes'</span>);
			}
			mom._z = zone;
		}
		<span class="hljs-keyword">if</span> (mom._z) {
			offset = mom._z.offset(mom);
			<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.abs(offset) &lt; <span class="hljs-number">16</span>) {
				offset = offset / <span class="hljs-number">60</span>;
			}
			<span class="hljs-keyword">if</span> (mom.utcOffset !== <span class="hljs-literal">undefined</span>) {
				mom.utcOffset(-offset, keepTime);
			} <span class="hljs-keyword">else</span> {
				mom.zone(offset, keepTime);
			}
		}
	};

	fn.tz = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
		<span class="hljs-keyword">if</span> (name) {
			<span class="hljs-keyword">this</span>._z = getZone(name);
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._z) {
				moment.updateOffset(<span class="hljs-keyword">this</span>);
			} <span class="hljs-keyword">else</span> {
				logError(<span class="hljs-string">"Moment Timezone has no data for "</span> + name + <span class="hljs-string">". See http://momentjs.com/timezone/docs/#/data-loading/."</span>);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._z) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._z.name; }
	};

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abbrWrap</span> (<span class="hljs-params">old</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._z) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._z.abbr(<span class="hljs-keyword">this</span>); }
			<span class="hljs-keyword">return</span> old.call(<span class="hljs-keyword">this</span>);
		};
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resetZoneWrap</span> (<span class="hljs-params">old</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">this</span>._z = <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">return</span> old.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
		};
	}

	fn.zoneName = abbrWrap(fn.zoneName);
	fn.zoneAbbr = abbrWrap(fn.zoneAbbr);
	fn.utc      = resetZoneWrap(fn.utc);

	moment.tz.setDefault = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
		<span class="hljs-keyword">if</span> (major &lt; <span class="hljs-number">2</span> || (major === <span class="hljs-number">2</span> &amp;&amp; minor &lt; <span class="hljs-number">9</span>)) {
			logError(<span class="hljs-string">'Moment Timezone setDefault() requires Moment.js &gt;= 2.9.0. You are using Moment.js '</span> + moment.version + <span class="hljs-string">'.'</span>);
		}
		moment.defaultZone = name ? getZone(name) : <span class="hljs-literal">null</span>;
		<span class="hljs-keyword">return</span> moment;
	};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Cloning a moment should include the _z property.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> momentProperties = moment.momentProperties;
	<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.prototype.toString.call(momentProperties) === <span class="hljs-string">'[object Array]'</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>moment 2.8.1+</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		momentProperties.push(<span class="hljs-string">'_z'</span>);
		momentProperties.push(<span class="hljs-string">'_a'</span>);
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (momentProperties) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>moment 2.7.0</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		momentProperties._z = <span class="hljs-literal">null</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>INJECT DATA</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-keyword">return</span> moment;
}));

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
