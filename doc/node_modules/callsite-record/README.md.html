<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/callsite-record/README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#callsite-record">callsite-record</a>
      </div>

      <div class="heading h2">
        <a href="#install">Install</a>
      </div>

      <div class="heading h2">
        <a href="#api">API</a>
      </div>

      <div class="heading h3">
        <a href="#createcallsiterecord-error-iscallsiteframe-callsiterecord">createCallsiteRecord(error, [isCallsiteFrame]) → CallsiteRecord</a>
      </div>

      <div class="heading h3">
        <a href="#createcallsiterecord-functionname-typename-callsiterecord">createCallsiteRecord(functionName, [typeName]) → CallsiteRecord</a>
      </div>

      <div class="heading h3">
        <a href="#callsiterecord">CallsiteRecord</a>
      </div>

      <div class="heading h4">
        <a href="#callsiterecord.render-renderoptions-promiselessstringgreater">CallsiteRecord.render([renderOptions]) → Promise&amp;lt;String&amp;gt;</a>
      </div>

      <div class="heading h4">
        <a href="#callsiterecord.rendersync-renderoptions-string">CallsiteRecord.renderSync([renderOptions]) → String</a>
      </div>

      <div class="heading h5">
        <a href="#renderoptions.framesize">renderOptions.frameSize</a>
      </div>

      <div class="heading h5">
        <a href="#renderoptions.codeframe">renderOptions.codeFrame</a>
      </div>

      <div class="heading h5">
        <a href="#renderoptions.stack">renderOptions.stack</a>
      </div>

      <div class="heading h5">
        <a href="#renderoptions.stackfilter">renderOptions.stackFilter</a>
      </div>

      <div class="heading h5">
        <a href="#renderoptions.renderer">renderOptions.renderer</a>
      </div>

      <div class="heading h6">
        <a href="#renderers.default">renderers.default</a>
      </div>

      <div class="heading h6">
        <a href="#renderers.nocolor">renderers.noColor</a>
      </div>

      <div class="heading h6">
        <a href="#renderers.html">renderers.html</a>
      </div>

      <div class="heading h2">
        <a href="#related">Related</a>
      </div>

      <div class="heading h2">
        <a href="#author">Author</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="callsite-record">
  <h1>
    <a href="#callsite-record" name="callsite-record" class="pilcrow"></a>
callsite-record
  </h1>
</div>
<p><a href="https://travis-ci.org/inikulin/callsite-record"><img src="https://api.travis-ci.org/inikulin/callsite-record.svg" alt="Build Status"></a></p>
<p><em>Create fancy log entries for errors and function call sites.</em></p>
<p><strong>For Error:</strong></p>
<pre><code class="js"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> createCallsiteRecord = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFunc</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Yo!'</span>);
}

<span class="hljs-keyword">try</span> {
    myFunc();
}
<span class="hljs-keyword">catch</span>(err) {
    <span class="hljs-built_in">console</span>.log(createCallsiteRecord(err).renderSync());
}

</code></pre>
<p>⬇</p>
<p><img src="https://raw.githubusercontent.com/inikulin/callsite-record/master/media/example1.png" alt="example"></p>
<p><strong>For function call up in the stack:</strong></p>
<pre><code class="js"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> createCallsiteRecord = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func2</span> (<span class="hljs-params"></span>) </span>{
    (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func1</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.log(createCallsiteRecord(<span class="hljs-string">'func2'</span>).renderSync());
    })();
}

func2();
</code></pre>
<p>⬇</p>
<p><img src="https://raw.githubusercontent.com/inikulin/callsite-record/master/media/example2.png" alt="example"></p>
<p><strong>Additional goodies:</strong></p>
<ul>
<li>Use <a href="#renderoptionsrenderer.html">renderers</a> for different output formats, e.g. to produce output in HTML.</li>
<li>Use <a href="#renderoptionsstackfilter.html">stack filter</a> to produce clean and beautiful stacks, e.g. removing Node lib internal calls.</li>
</ul>
<div class="pilwrap" id="install">
  <h2>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h2>
</div>
<pre><code>npm install callsite-record
</code></pre>
<div class="pilwrap" id="api">
  <h2>
    <a href="#api" name="api" class="pilcrow"></a>
API
  </h2>
</div>
<div class="pilwrap" id="createcallsiterecord-error-iscallsiteframe-callsiterecord">
  <h3>
    <a href="#createcallsiterecord-error-iscallsiteframe-callsiterecord" name="createcallsiterecord-error-iscallsiteframe-callsiterecord" class="pilcrow"></a>
createCallsiteRecord(error, [isCallsiteFrame]) → CallsiteRecord
  </h3>
</div>
<p>You can generate a callsite for any stack frame, not only the topmost one. Use the <code>isCallsiteFrame</code> function to select
a frame. This function is called for each frame starting from the top. Return <code>true</code> for the desired frame to generate
the callsite.</p>
<p><em>Example:</em></p>
<pre><code class="js"><span class="hljs-keyword">const</span> createCallsiteRecord = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>);

<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"We're doomed"</span>);
}
<span class="hljs-keyword">catch</span>(err) {
    <span class="hljs-keyword">const</span> record = createCallsiteRecord(err);
}
</code></pre>
<div class="pilwrap" id="createcallsiterecord-functionname-typename-callsiterecord">
  <h3>
    <a href="#createcallsiterecord-functionname-typename-callsiterecord" name="createcallsiterecord-functionname-typename-callsiterecord" class="pilcrow"></a>
createCallsiteRecord(functionName, [typeName]) → CallsiteRecord
  </h3>
</div>
<p>Creates <code>CallsiteRecord</code> for the function up in the call stack specified by <code>functionName</code>. You can optionally specify a
<code>typeName</code> if the function is a method. If the function is a constructor set <code>functionName</code> to <code>constructor</code>.</p>
<p><em>Example:</em></p>
<pre><code class="js"><span class="hljs-keyword">const</span> createCallsiteRecord = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>);

(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func1</span>(<span class="hljs-params"></span>) </span>{
    (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func2</span>(<span class="hljs-params"></span>) </span>{
        (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func3</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">const</span> record = createCallsiteRecord(<span class="hljs-string">'func2'</span>);
        })();
    })();
})();
</code></pre>
<div class="pilwrap" id="callsiterecord">
  <h3>
    <a href="#callsiterecord" name="callsiterecord" class="pilcrow"></a>
CallsiteRecord
  </h3>
</div>
<div class="pilwrap" id="callsiterecord.render-renderoptions-promiselessstringgreater">
  <h4>
    <a href="#callsiterecord.render-renderoptions-promiselessstringgreater" name="callsiterecord.render-renderoptions-promiselessstringgreater" class="pilcrow"></a>
CallsiteRecord.render([renderOptions]) → Promise&lt;String&gt;
  </h4>
</div>
<p>Renders call site record to the string.</p>
<p><em>Example:</em></p>
<pre><code class="js">record.render().then(<span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(str));
</code></pre>
<div class="pilwrap" id="callsiterecord.rendersync-renderoptions-string">
  <h4>
    <a href="#callsiterecord.rendersync-renderoptions-string" name="callsiterecord.rendersync-renderoptions-string" class="pilcrow"></a>
CallsiteRecord.renderSync([renderOptions]) → String
  </h4>
</div>
<p>Sync version of the <code>CallsiteRecord.render</code>.</p>
<div class="pilwrap" id="renderoptions.framesize">
  <h5>
    <a href="#renderoptions.framesize" name="renderoptions.framesize" class="pilcrow"></a>
renderOptions.frameSize
  </h5>
</div>
<p>Specifies the number of lines rendered above and below the call site in the code frame. <strong>Default:</strong> <code>5</code>.</p>
<p><em>Example:</em></p>
<pre><code class="js"><span class="hljs-built_in">console</span>.log(record.renderSync({ <span class="hljs-attr">frameSize</span>: <span class="hljs-number">0</span> }));
<span class="hljs-comment">// &gt; 12 |    func1();</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-built_in">console</span>.log(record.renderSync({ <span class="hljs-attr">frameSize</span>: <span class="hljs-number">1</span> }));
<span class="hljs-comment">//   11 |(function func2() {</span>
<span class="hljs-comment">// &gt; 12 |    func1();</span>
<span class="hljs-comment">//   13 |})();</span>
<span class="hljs-comment">// ...</span>
</code></pre>
<div class="pilwrap" id="renderoptions.codeframe">
  <h5>
    <a href="#renderoptions.codeframe" name="renderoptions.codeframe" class="pilcrow"></a>
renderOptions.codeFrame
  </h5>
</div>
<p>Specifies if code frame should be rendered. If disabled only stack will be rendered. <strong>Default:</strong> <code>true</code>.</p>
<div class="pilwrap" id="renderoptions.stack">
  <h5>
    <a href="#renderoptions.stack" name="renderoptions.stack" class="pilcrow"></a>
renderOptions.stack
  </h5>
</div>
<p>Specifies if stack trace should be rendered in addition to the code frame. <strong>Default:</strong> <code>true</code>.</p>
<div class="pilwrap" id="renderoptions.stackfilter">
  <h5>
    <a href="#renderoptions.stackfilter" name="renderoptions.stackfilter" class="pilcrow"></a>
renderOptions.stackFilter
  </h5>
</div>
<p>Function that will be used to filter stack frames. Function accepts 2 arguments:</p>
<ul>
<li><code>stackFrame</code> - stack entry.</li>
<li><code>idx</code> - index of the frame.</li>
<li><code>isV8StackFrame</code> - if <code>true</code> then <code>stackFrame</code> is a V8 <a href="https://github.com/v8/v8/wiki/Stack-Trace-API#customizing-stack-traces">CallSite</a> object.
Otherwise it's a <a href="https://github.com/stacktracejs/stackframe">StackFrame</a> object.</li>
</ul>
<p><strong>Default:</strong> <code>null</code>.</p>
<p><em>Example:</em></p>
<pre><code class="js"><span class="hljs-keyword">const</span> sep = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>).sep;

<span class="hljs-comment">// Remove node core lib calls from the stack trace</span>
record.renderSync({ <span class="hljs-attr">stackFilter</span>: <span class="hljs-function"><span class="hljs-params">frame</span> =&gt;</span> frame.getFileName().indexOf(sep) &gt; <span class="hljs-number">-1</span> });
</code></pre>
<div class="pilwrap" id="renderoptions.renderer">
  <h5>
    <a href="#renderoptions.renderer" name="renderoptions.renderer" class="pilcrow"></a>
renderOptions.renderer
  </h5>
</div>
<p>Specifies the output format of the rendering. <strong>Default:</strong> <code>renderers.default</code>. You can pass your own
renderer object (<a href="https://github.com/inikulin/callsite-record/tree/master/lib/renderers">example implementations</a>) or use
one of the built-in renderers:</p>
<div class="pilwrap" id="renderers.default">
  <h6>
    <a href="#renderers.default" name="renderers.default" class="pilcrow"></a>
renderers.default
  </h6>
</div>
<p>Provides ANSI-colored output as shown above.</p>
<p><em>Usage:</em></p>
<pre><code class="js"><span class="hljs-keyword">const</span> defaultRenderer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>).renderers.default;

record.renderSync({ <span class="hljs-attr">renderer</span>: defaultRenderer });
</code></pre>
<div class="pilwrap" id="renderers.nocolor">
  <h6>
    <a href="#renderers.nocolor" name="renderers.nocolor" class="pilcrow"></a>
renderers.noColor
  </h6>
</div>
<p>Same as <code>default</code> renderer but without colors.</p>
<p><em>Usage:</em></p>
<pre><code class="js"><span class="hljs-keyword">const</span> noColorRenderer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>).renderers.noColor;

record.renderSync({ <span class="hljs-attr">renderer</span>: noColorRenderer });
</code></pre>
<div class="pilwrap" id="renderers.html">
  <h6>
    <a href="#renderers.html" name="renderers.html" class="pilcrow"></a>
renderers.html
  </h6>
</div>
<p>Outputs HTML that can be later decorated with the CSS and embeded into the web page. <a href="https://github.com/inikulin/callsite-record/blob/master/test/data/expected-html/0.html">Example output</a>.</p>
<p><em>Usage:</em></p>
<pre><code class="js"><span class="hljs-keyword">const</span> htmlRenderer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'callsite-record'</span>).renderers.html;

record.renderSync({ <span class="hljs-attr">renderer</span>: html });
</code></pre>
<div class="pilwrap" id="related">
  <h2>
    <a href="#related" name="related" class="pilcrow"></a>
Related
  </h2>
</div>
<ul>
<li><a href="https://github.com/inikulin/is-es2016-keyword">is-es2016-keyword</a> - Determine if string is an ES2016 keyword.</li>
<li><a href="https://github.com/inikulin/highlight-es">highlight-es</a> - Highlight ECMAScript syntax for the console or any other medium.</li>
</ul>
<div class="pilwrap" id="author">
  <h2>
    <a href="#author" name="author" class="pilcrow"></a>
Author
  </h2>
</div>
<p><a href="https://github.com/inikulin">Ivan Nikulin</a> (ifaaan@gmail.com)</p>
</div>
  </div>
</body>
</html>
