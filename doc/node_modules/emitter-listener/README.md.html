<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/emitter-listener/README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h2">
        <a href="#add-dynamic-instrumentation-to-emitters">Add dynamic instrumentation to emitters</a>
      </div>

      <div class="heading h3">
        <a href="#mandatory-disclaimer">Mandatory disclaimer</a>
      </div>

      <div class="heading h4">
        <a href="#wrapemitter-emitter-mark-prepare">wrapEmitter(emitter, mark, prepare)</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="add-dynamic-instrumentation-to-emitters">
  <h2>
    <a href="#add-dynamic-instrumentation-to-emitters" name="add-dynamic-instrumentation-to-emitters" class="pilcrow"></a>
Add dynamic instrumentation to emitters
  </h2>
</div>
<p><code>shimmer</code> does a bunch of the work necessary to wrap other methods in
a wrapper you provide:</p>
<pre><code class="javascript"><span class="hljs-keyword">var</span> EventEmitter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'events'</span>).EventEmitter;
<span class="hljs-keyword">var</span> wrapEmitter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'emitter-listener'</span>);

<span class="hljs-keyword">var</span> ee = <span class="hljs-keyword">new</span> EventEmitter();

<span class="hljs-keyword">var</span> id = <span class="hljs-number">0</span>;

wrapEmitter(
  ee,
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mark</span>(<span class="hljs-params">listener</span>) </span>{
    listener.id = id++;
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prepare</span>(<span class="hljs-params">listener</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'listener id is %d'</span>, listener.id);
  }
);
</code></pre>
<div class="pilwrap" id="mandatory-disclaimer">
  <h3>
    <a href="#mandatory-disclaimer" name="mandatory-disclaimer" class="pilcrow"></a>
Mandatory disclaimer
  </h3>
</div>
<p>There are times when it's necessary to monkeypatch default behavior in
JavaScript and Node. However, changing the behavior of the runtime on the fly
is rarely a good idea, and you should be using this module because you need to,
not because it seems like fun.</p>
<div class="pilwrap" id="wrapemitter-emitter-mark-prepare">
  <h4>
    <a href="#wrapemitter-emitter-mark-prepare" name="wrapemitter-emitter-mark-prepare" class="pilcrow"></a>
wrapEmitter(emitter, mark, prepare)
  </h4>
</div>
<p>Wrap an EventEmitter's event listeners. Each listener will be passed to
<code>mark</code> when it is registered with <code>.addListener()</code> or <code>.on()</code>, and then
each listener is passed to <code>prepare</code> to be wrapped before it's called
by the <code>.emit()</code> call. <code>wrapListener</code> deals with the single listener
vs array of listeners logic, and also ensures that edge cases like
<code>.removeListener()</code> being called from within an <code>.emit()</code> for the same
event type is handled properly.</p>
<p>The wrapped EE can be restored to its pristine state by using
emitter.__unwrap(), but this should only be used if you <em>really</em> know
what you're doing.</p>
</div>
  </div>
</body>
</html>
