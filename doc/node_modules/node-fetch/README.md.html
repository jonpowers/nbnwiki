<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/node-fetch/README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#node-fetch">node-fetch</a>
      </div>

      <div class="heading h1">
        <a href="#motivation">Motivation</a>
      </div>

      <div class="heading h1">
        <a href="#features">Features</a>
      </div>

      <div class="heading h1">
        <a href="#difference-from-client-side-fetch">Difference from client-side fetch</a>
      </div>

      <div class="heading h1">
        <a href="#install">Install</a>
      </div>

      <div class="heading h1">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h1">
        <a href="#api">API</a>
      </div>

      <div class="heading h2">
        <a href="#fetch-url-options">fetch(url, options)</a>
      </div>

      <div class="heading h3">
        <a href="#url">Url</a>
      </div>

      <div class="heading h3">
        <a href="#options">Options</a>
      </div>

      <div class="heading h1">
        <a href="#license">License</a>
      </div>

      <div class="heading h1">
        <a href="#acknowledgement">Acknowledgement</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="node-fetch">
  <h1>
    <a href="#node-fetch" name="node-fetch" class="pilcrow"></a>
node-fetch
  </h1>
</div>
<p><a href="https://www.npmjs.com/package/node-fetch"><img src="https://img.shields.io/npm/v/node-fetch.svg?style=flat-square" alt="npm version"></a>
<a href="https://travis-ci.org/bitinn/node-fetch"><img src="https://img.shields.io/travis/bitinn/node-fetch.svg?style=flat-square" alt="build status"></a>
<a href="https://coveralls.io/r/bitinn/node-fetch"><img src="https://img.shields.io/coveralls/bitinn/node-fetch.svg?style=flat-square" alt="coverage status"></a></p>
<p>A light-weight module that brings <code>window.fetch</code> to Node.js</p>
<div class="pilwrap" id="motivation">
  <h1>
    <a href="#motivation" name="motivation" class="pilcrow"></a>
Motivation
  </h1>
</div>
<p>Instead of implementing <code>XMLHttpRequest</code> in Node.js to run browser-specific <a href="https://github.com/github/fetch">Fetch polyfill</a>, why not go from native <code>http</code> to <code>Fetch</code> API directly? Hence <code>node-fetch</code>, minimal code for a <code>window.fetch</code> compatible API on Node.js runtime.</p>
<p>See Matt Andrews' <a href="https://github.com/matthew-andrews/isomorphic-fetch">isomorphic-fetch</a> for isomorphic usage (exports <code>node-fetch</code> for server-side, <code>whatwg-fetch</code> for client-side).</p>
<div class="pilwrap" id="features">
  <h1>
    <a href="#features" name="features" class="pilcrow"></a>
Features
  </h1>
</div>
<ul>
<li>Stay consistent with <code>window.fetch</code> API.</li>
<li>Make conscious trade-off when following <a href="https://fetch.spec.whatwg.org/">whatwg fetch spec</a> and <a href="https://streams.spec.whatwg.org/">stream spec</a> implementation details, document known difference.</li>
<li>Use native promise, but allow substituting it with [insert your favorite promise library].</li>
<li>Use native stream for body, on both request and response.</li>
<li>Decode content encoding (gzip/deflate) properly, and convert string output (such as <code>res.text()</code> and <code>res.json()</code>) to UTF-8 automatically.</li>
<li>Useful extensions such as timeout, redirect limit, response size limit, <a href="https://github.com/bitinn/node-fetch/blob/master/ERROR-HANDLING.md">explicit errors</a> for troubleshooting.</li>
</ul>
<div class="pilwrap" id="difference-from-client-side-fetch">
  <h1>
    <a href="#difference-from-client-side-fetch" name="difference-from-client-side-fetch" class="pilcrow"></a>
Difference from client-side fetch
  </h1>
</div>
<ul>
<li>See <a href="https://github.com/bitinn/node-fetch/blob/master/LIMITS.md">Known Differences</a> for details.</li>
<li>If you happen to use a missing feature that <code>window.fetch</code> offers, feel free to open an issue.</li>
<li>Pull requests are welcomed too!</li>
</ul>
<div class="pilwrap" id="install">
  <h1>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h1>
</div>
<p><code>npm install node-fetch --save</code></p>
<div class="pilwrap" id="usage">
  <h1>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h1>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> fetch = <span class="hljs-built_in">require</span>(<span class="hljs-string">'node-fetch'</span>);

<span class="hljs-comment">// if you are on node v0.10, set a Promise library first, eg.</span>
<span class="hljs-comment">// fetch.Promise = require('bluebird');</span>

<span class="hljs-comment">// plain text or html</span>

fetch(<span class="hljs-string">'https://github.com/'</span>)
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.text();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">body</span>) </span>{
		<span class="hljs-built_in">console</span>.log(body);
	});

<span class="hljs-comment">// json</span>

fetch(<span class="hljs-string">'https://api.github.com/users/github'</span>)
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.json();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>) </span>{
		<span class="hljs-built_in">console</span>.log(json);
	});

<span class="hljs-comment">// catching network error</span>
<span class="hljs-comment">// 3xx-5xx responses are NOT network errors, and should be handled in then()</span>
<span class="hljs-comment">// you only need one catch() at the end of your promise chain</span>

fetch(<span class="hljs-string">'http://domain.invalid/'</span>)
	.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
		<span class="hljs-built_in">console</span>.log(err);
	});

<span class="hljs-comment">// stream</span>
<span class="hljs-comment">// the node.js way is to use stream when possible</span>

fetch(<span class="hljs-string">'https://assets-cdn.github.com/images/modules/logos_page/Octocat.png'</span>)
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">var</span> dest = fs.createWriteStream(<span class="hljs-string">'./octocat.png'</span>);
		res.body.pipe(dest);
	});

<span class="hljs-comment">// buffer</span>
<span class="hljs-comment">// if you prefer to cache binary data in full, use buffer()</span>
<span class="hljs-comment">// note that buffer() is a node-fetch only API</span>

<span class="hljs-keyword">var</span> fileType = <span class="hljs-built_in">require</span>(<span class="hljs-string">'file-type'</span>);
fetch(<span class="hljs-string">'https://assets-cdn.github.com/images/modules/logos_page/Octocat.png'</span>)
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.buffer();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">buffer</span>) </span>{
		fileType(buffer);
	});

<span class="hljs-comment">// meta</span>

fetch(<span class="hljs-string">'https://github.com/'</span>)
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-built_in">console</span>.log(res.ok);
		<span class="hljs-built_in">console</span>.log(res.status);
		<span class="hljs-built_in">console</span>.log(res.statusText);
		<span class="hljs-built_in">console</span>.log(res.headers.raw());
		<span class="hljs-built_in">console</span>.log(res.headers.get(<span class="hljs-string">'content-type'</span>));
	});

<span class="hljs-comment">// post</span>

fetch(<span class="hljs-string">'http://httpbin.org/post'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'a=1'</span> })
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.json();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>) </span>{
		<span class="hljs-built_in">console</span>.log(json);
	});

<span class="hljs-comment">// post with stream from resumer</span>

<span class="hljs-keyword">var</span> resumer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'resumer'</span>);
<span class="hljs-keyword">var</span> stream = resumer().queue(<span class="hljs-string">'a=1'</span>).end();
fetch(<span class="hljs-string">'http://httpbin.org/post'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>, <span class="hljs-attr">body</span>: stream })
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.json();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>) </span>{
		<span class="hljs-built_in">console</span>.log(json);
	});

<span class="hljs-comment">// post with form-data (detect multipart)</span>

<span class="hljs-keyword">var</span> FormData = <span class="hljs-built_in">require</span>(<span class="hljs-string">'form-data'</span>);
<span class="hljs-keyword">var</span> form = <span class="hljs-keyword">new</span> FormData();
form.append(<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>);
fetch(<span class="hljs-string">'http://httpbin.org/post'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>, <span class="hljs-attr">body</span>: form })
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.json();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>) </span>{
		<span class="hljs-built_in">console</span>.log(json);
	});

<span class="hljs-comment">// post with form-data (custom headers)</span>
<span class="hljs-comment">// note that getHeaders() is non-standard API</span>

<span class="hljs-keyword">var</span> FormData = <span class="hljs-built_in">require</span>(<span class="hljs-string">'form-data'</span>);
<span class="hljs-keyword">var</span> form = <span class="hljs-keyword">new</span> FormData();
form.append(<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>);
fetch(<span class="hljs-string">'http://httpbin.org/post'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>, <span class="hljs-attr">body</span>: form, <span class="hljs-attr">headers</span>: form.getHeaders() })
	.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
		<span class="hljs-keyword">return</span> res.json();
	}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>) </span>{
		<span class="hljs-built_in">console</span>.log(json);
	});

<span class="hljs-comment">// node 0.12+, yield with co</span>

<span class="hljs-keyword">var</span> co = <span class="hljs-built_in">require</span>(<span class="hljs-string">'co'</span>);
co(<span class="hljs-function"><span class="hljs-keyword">function</span> *(<span class="hljs-params"></span>) </span>{
	<span class="hljs-keyword">var</span> res = <span class="hljs-keyword">yield</span> fetch(<span class="hljs-string">'https://api.github.com/users/github'</span>);
	<span class="hljs-keyword">var</span> json = <span class="hljs-keyword">yield</span> res.json();
	<span class="hljs-built_in">console</span>.log(res);
});
</code></pre>
<p>See <a href="https://github.com/bitinn/node-fetch/blob/master/test/test.js">test cases</a> for more examples.</p>
<div class="pilwrap" id="api">
  <h1>
    <a href="#api" name="api" class="pilcrow"></a>
API
  </h1>
</div>
<div class="pilwrap" id="fetch-url-options">
  <h2>
    <a href="#fetch-url-options" name="fetch-url-options" class="pilcrow"></a>
fetch(url, options)
  </h2>
</div>
<p>Returns a <code>Promise</code></p>
<div class="pilwrap" id="url">
  <h3>
    <a href="#url" name="url" class="pilcrow"></a>
Url
  </h3>
</div>
<p>Should be an absolute url, eg <code>http://example.com/</code></p>
<div class="pilwrap" id="options">
  <h3>
    <a href="#options" name="options" class="pilcrow"></a>
Options
  </h3>
</div>
<p>default values are shown, note that only <code>method</code>, <code>headers</code>, <code>redirect</code> and <code>body</code> are allowed in <code>window.fetch</code>, others are node.js extensions.</p>
<pre><code>{
	method: 'GET'
	, headers: {}        // request header. format {a:'1'} or {b:['1','2','3']}
	, redirect: 'follow' // set to `manual` to extract redirect headers, `error` to reject redirect
	, follow: 20         // maximum redirect count. 0 to not follow redirect
	, timeout: 0         // req/res timeout in ms, it resets on redirect. 0 to disable (OS limit applies)
	, compress: true     // support gzip/deflate content encoding. false to disable
	, size: 0            // maximum response body size in bytes. 0 to disable
	, body: empty        // request body. can be a string, buffer, readable stream
	, agent: null        // http.Agent instance, allows custom proxy, certificate etc.
}
</code></pre>
<div class="pilwrap" id="license">
  <h1>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h1>
</div>
<p>MIT</p>
<div class="pilwrap" id="acknowledgement">
  <h1>
    <a href="#acknowledgement" name="acknowledgement" class="pilcrow"></a>
Acknowledgement
  </h1>
</div>
<p>Thanks to <a href="https://github.com/github/fetch">github/fetch</a> for providing a solid implementation reference.</p>
</div>
  </div>
</body>
</html>
