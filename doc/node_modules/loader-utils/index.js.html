<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/loader-utils/index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> JSON5 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"json5"</span>);
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);
<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">"util"</span>);
<span class="hljs-keyword">var</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">"os"</span>);
<span class="hljs-keyword">var</span> assign = <span class="hljs-built_in">require</span>(<span class="hljs-string">"object-assign"</span>);
<span class="hljs-keyword">var</span> emojiRegex = <span class="hljs-regexp">/[\uD800-\uDFFF]./</span>;
<span class="hljs-keyword">var</span> emojiList = <span class="hljs-built_in">require</span>(<span class="hljs-string">"emojis-list"</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">emoji</span>) </span>{
	<span class="hljs-keyword">return</span> emojiRegex.test(emoji)
});
<span class="hljs-keyword">var</span> matchAbsolutePath = <span class="hljs-regexp">/^\/|^[A-Z]:[/\\]|^\\\\/i</span>; <span class="hljs-comment">// node 0.10 does not support path.isAbsolute()</span>
<span class="hljs-keyword">var</span> matchAbsoluteWin32Path = <span class="hljs-regexp">/^[A-Z]:[/\\]|^\\\\/i</span>;
<span class="hljs-keyword">var</span> matchRelativePath = <span class="hljs-regexp">/^\.\.?[/\\]/</span>;

<span class="hljs-keyword">var</span> baseEncodeTables = {
	<span class="hljs-number">26</span>: <span class="hljs-string">"abcdefghijklmnopqrstuvwxyz"</span>,
	<span class="hljs-number">32</span>: <span class="hljs-string">"123456789abcdefghjkmnpqrstuvwxyz"</span>, <span class="hljs-comment">// no 0lio</span>
	<span class="hljs-number">36</span>: <span class="hljs-string">"0123456789abcdefghijklmnopqrstuvwxyz"</span>,
	<span class="hljs-number">49</span>: <span class="hljs-string">"abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"</span>, <span class="hljs-comment">// no lIO</span>
	<span class="hljs-number">52</span>: <span class="hljs-string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>,
	<span class="hljs-number">58</span>: <span class="hljs-string">"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"</span>, <span class="hljs-comment">// no 0lIO</span>
	<span class="hljs-number">62</span>: <span class="hljs-string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>,
	<span class="hljs-number">64</span>: <span class="hljs-string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"</span>
};
<span class="hljs-keyword">var</span> emojiCache = {};
<span class="hljs-keyword">var</span> parseQueryDeprecationWarning = util.deprecate(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
	<span class="hljs-string">"loaderUtils.parseQuery() received a non-string value which can be problematic, "</span> +
	<span class="hljs-string">"see https://github.com/webpack/loader-utils/issues/56"</span> + os.EOL +
	<span class="hljs-string">"parseQuery() will be replaced with getOptions() in the next major version of loader-utils."</span>
);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeStringToEmoji</span>(<span class="hljs-params">content, length</span>) </span>{
	<span class="hljs-keyword">if</span> (emojiCache[content]) <span class="hljs-keyword">return</span> emojiCache[content];
	length = length || <span class="hljs-number">1</span>;
	<span class="hljs-keyword">var</span> emojis = [];
	<span class="hljs-keyword">do</span> {
		<span class="hljs-keyword">var</span> index = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * emojiList.length);
		emojis.push(emojiList[index]);
		emojiList.splice(index, <span class="hljs-number">1</span>);
	} <span class="hljs-keyword">while</span> (--length &gt; <span class="hljs-number">0</span>);
	<span class="hljs-keyword">var</span> emojiEncoding = emojis.join(<span class="hljs-string">''</span>);
	emojiCache[content] = emojiEncoding;
	<span class="hljs-keyword">return</span> emojiEncoding;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeBufferToBase</span>(<span class="hljs-params">buffer, base</span>) </span>{
	<span class="hljs-keyword">var</span> encodeTable = baseEncodeTables[base];
	<span class="hljs-keyword">if</span> (!encodeTable) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Unknown encoding base"</span> + base);

	<span class="hljs-keyword">var</span> readLength = buffer.length;

	<span class="hljs-keyword">var</span> Big = <span class="hljs-built_in">require</span>(<span class="hljs-string">'big.js'</span>);
	Big.RM = Big.DP = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> Big(<span class="hljs-number">0</span>);
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = readLength - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
		b = b.times(<span class="hljs-number">256</span>).plus(buffer[i]);
	}

	<span class="hljs-keyword">var</span> output = <span class="hljs-string">""</span>;
	<span class="hljs-keyword">while</span> (b.gt(<span class="hljs-number">0</span>)) {
		output = encodeTable[b.mod(base)] + output;
		b = b.div(base);
	}

	Big.DP = <span class="hljs-number">20</span>;
	Big.RM = <span class="hljs-number">1</span>;

	<span class="hljs-keyword">return</span> output;
}

exports.parseQuery = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseQuery</span>(<span class="hljs-params">query</span>) </span>{
	<span class="hljs-keyword">var</span> specialValues = {
		<span class="hljs-string">'null'</span>: <span class="hljs-literal">null</span>,
		<span class="hljs-string">'true'</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-string">'false'</span>: <span class="hljs-literal">false</span>
	};
	<span class="hljs-keyword">if</span>(!query) <span class="hljs-keyword">return</span> {};
	<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> query !== <span class="hljs-string">"string"</span>) {
		parseQueryDeprecationWarning();
		<span class="hljs-keyword">return</span> query;
	}
	<span class="hljs-keyword">if</span>(query.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) !== <span class="hljs-string">"?"</span>)
		<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"a valid query string passed to parseQuery should begin with '?'"</span>);
	query = query.substr(<span class="hljs-number">1</span>);
	<span class="hljs-keyword">var</span> queryLength = query.length;
	<span class="hljs-keyword">if</span>(query.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) === <span class="hljs-string">"{"</span> &amp;&amp; query.substr(<span class="hljs-number">-1</span>) === <span class="hljs-string">"}"</span>) {
		<span class="hljs-keyword">return</span> JSON5.parse(query);
	}
	<span class="hljs-keyword">var</span> queryArgs = query.split(<span class="hljs-regexp">/[,\&amp;]/g</span>);
	<span class="hljs-keyword">var</span> result = {};
	queryArgs.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) </span>{
		<span class="hljs-keyword">var</span> idx = arg.indexOf(<span class="hljs-string">"="</span>);
		<span class="hljs-keyword">if</span>(idx &gt;= <span class="hljs-number">0</span>) {
			<span class="hljs-keyword">var</span> name = arg.substr(<span class="hljs-number">0</span>, idx);
			<span class="hljs-keyword">var</span> value = <span class="hljs-built_in">decodeURIComponent</span>(arg.substr(idx+<span class="hljs-number">1</span>));
			<span class="hljs-keyword">if</span> (specialValues.hasOwnProperty(value)) {
				value = specialValues[value];
			}
			<span class="hljs-keyword">if</span>(name.substr(<span class="hljs-number">-2</span>) === <span class="hljs-string">"[]"</span>) {
				name = <span class="hljs-built_in">decodeURIComponent</span>(name.substr(<span class="hljs-number">0</span>, name.length<span class="hljs-number">-2</span>));
				<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">Array</span>.isArray(result[name]))
					result[name] = [];
				result[name].push(value);
			} <span class="hljs-keyword">else</span> {
				name = <span class="hljs-built_in">decodeURIComponent</span>(name);
				result[name] = value;
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">if</span>(arg.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) === <span class="hljs-string">"-"</span>) {
				result[<span class="hljs-built_in">decodeURIComponent</span>(arg.substr(<span class="hljs-number">1</span>))] = <span class="hljs-literal">false</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arg.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) === <span class="hljs-string">"+"</span>) {
				result[<span class="hljs-built_in">decodeURIComponent</span>(arg.substr(<span class="hljs-number">1</span>))] = <span class="hljs-literal">true</span>;
			} <span class="hljs-keyword">else</span> {
				result[<span class="hljs-built_in">decodeURIComponent</span>(arg)] = <span class="hljs-literal">true</span>;
			}
		}
	});
	<span class="hljs-keyword">return</span> result;
};

exports.getLoaderConfig = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">loaderContext, defaultConfigKey</span>) </span>{
	<span class="hljs-keyword">var</span> query = exports.parseQuery(loaderContext.query);
	<span class="hljs-keyword">var</span> configKey = query.config || defaultConfigKey;
	<span class="hljs-keyword">if</span> (configKey) {
		<span class="hljs-keyword">var</span> config = loaderContext.options[configKey] || {};
		<span class="hljs-keyword">delete</span> query.config;
		<span class="hljs-keyword">return</span> assign({}, config, query);
	}

	<span class="hljs-keyword">return</span> query;
};

exports.stringifyRequest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">loaderContext, request</span>) </span>{
	<span class="hljs-keyword">var</span> splitted = request.split(<span class="hljs-string">"!"</span>);
	<span class="hljs-keyword">var</span> context = loaderContext.context || (loaderContext.options &amp;&amp; loaderContext.options.context);
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(splitted.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">part</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>First, separate singlePath from query, because the query might contain paths again</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">var</span> splittedPart = part.match(<span class="hljs-regexp">/^(.*?)(\?.*)/</span>);
		<span class="hljs-keyword">var</span> singlePath = splittedPart ? splittedPart[<span class="hljs-number">1</span>] : part;
		<span class="hljs-keyword">var</span> query = splittedPart ? splittedPart[<span class="hljs-number">2</span>] : <span class="hljs-string">""</span>;
		<span class="hljs-keyword">if</span>(matchAbsolutePath.test(singlePath) &amp;&amp; context) {
			singlePath = path.relative(context, singlePath);
			<span class="hljs-keyword">if</span>(matchAbsolutePath.test(singlePath)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>If singlePath still matches an absolute path, singlePath was on a different drive than context.
In this case, we leave the path platform-specific without replacing any separators.
@see https://github.com/webpack/loader-utils/pull/14</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">				<span class="hljs-keyword">return</span> singlePath + query;
			}
			<span class="hljs-keyword">if</span>(matchRelativePath.test(singlePath) === <span class="hljs-literal">false</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Ensure that the relative path starts at least with ./ otherwise it would be a request into the modules directory (like node_modules).</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">				singlePath = <span class="hljs-string">"./"</span> + singlePath;
			}
		}
		<span class="hljs-keyword">return</span> singlePath.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">"/"</span>) + query;
	}).join(<span class="hljs-string">"!"</span>));
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dotRequest</span>(<span class="hljs-params">obj</span>) </span>{
	<span class="hljs-keyword">return</span> obj.request;
}

exports.getRemainingRequest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">loaderContext</span>) </span>{
	<span class="hljs-keyword">if</span>(loaderContext.remainingRequest)
		<span class="hljs-keyword">return</span> loaderContext.remainingRequest;
	<span class="hljs-keyword">var</span> request = loaderContext.loaders.slice(loaderContext.loaderIndex+<span class="hljs-number">1</span>).map(dotRequest).concat([loaderContext.resource]);
	<span class="hljs-keyword">return</span> request.join(<span class="hljs-string">"!"</span>);
};

exports.getCurrentRequest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">loaderContext</span>) </span>{
	<span class="hljs-keyword">if</span>(loaderContext.currentRequest)
		<span class="hljs-keyword">return</span> loaderContext.currentRequest;
	<span class="hljs-keyword">var</span> request = loaderContext.loaders.slice(loaderContext.loaderIndex).map(dotRequest).concat([loaderContext.resource]);
	<span class="hljs-keyword">return</span> request.join(<span class="hljs-string">"!"</span>);
};

exports.isUrlRequest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, root</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>An URL is not an request if</p>
<ol>
<li>it's a Data Url</li>
<li>it's an absolute url or and protocol-relative</li>
<li>it's some kind of url for a template</li>
</ol>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^data:|^chrome-extension:|^(https?:)?\/\/|^[\{\}\[\]#*;,'§\$%&amp;\(=?`´\^°&lt;&gt;]/</span>.test(url)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<ol start="4">
<li>It's also not an request if root isn't set and it's a root-relative url</li>
</ol>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span>((root === <span class="hljs-literal">undefined</span> || root === <span class="hljs-literal">false</span>) &amp;&amp; <span class="hljs-regexp">/^\//</span>.test(url)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
};

exports.urlToRequest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, root</span>) </span>{
	<span class="hljs-keyword">var</span> moduleRequestRegex = <span class="hljs-regexp">/^[^?]*~/</span>;
	<span class="hljs-keyword">var</span> request;

	<span class="hljs-keyword">if</span>(matchAbsoluteWin32Path.test(url)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>absolute windows path, keep it</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		request = url;
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(root !== <span class="hljs-literal">undefined</span> &amp;&amp; root !== <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-regexp">/^\//</span>.test(url)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>if root is set and the url is root-relative</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">switch</span>(<span class="hljs-keyword">typeof</span> root) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<ol>
<li>root is a string: root is prefixed to the url</li>
</ol>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>special case: <code>~</code> roots convert to module request</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">				<span class="hljs-keyword">if</span> (moduleRequestRegex.test(root)) {
					request = root.replace(<span class="hljs-regexp">/([^~\/])$/</span>, <span class="hljs-string">"$1/"</span>) + url.slice(<span class="hljs-number">1</span>);
				} <span class="hljs-keyword">else</span> {
					request = root + url;
				}
				<span class="hljs-keyword">break</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<ol start="2">
<li>root is <code>true</code>: absolute paths are allowed
*nix only, windows-style absolute paths are always allowed as they doesn't start with a <code>/</code></li>
</ol>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">case</span> <span class="hljs-string">"boolean"</span>:
				request = url;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">default</span>:
				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Unexpected parameters to loader-utils 'urlToRequest': url = "</span> + url + <span class="hljs-string">", root = "</span> + root + <span class="hljs-string">"."</span>);
		}
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^\.\.?\//</span>.test(url)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>A relative url stays</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		request = url;
	} <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>every other url is threaded like a relative url</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		request = <span class="hljs-string">"./"</span> + url;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>A <code>~</code> makes the url an module</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span> (moduleRequestRegex.test(request)) {
		request = request.replace(moduleRequestRegex, <span class="hljs-string">""</span>);
	}

	<span class="hljs-keyword">return</span> request;
};

exports.parseString = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseString</span>(<span class="hljs-params">str</span>) </span>{
	<span class="hljs-keyword">try</span> {
		<span class="hljs-keyword">if</span>(str[<span class="hljs-number">0</span>] === <span class="hljs-string">'"'</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(str);
		<span class="hljs-keyword">if</span>(str[<span class="hljs-number">0</span>] === <span class="hljs-string">"'"</span> &amp;&amp; str.substr(str.length - <span class="hljs-number">1</span>) === <span class="hljs-string">"'"</span>) {
			<span class="hljs-keyword">return</span> parseString(str.replace(<span class="hljs-regexp">/\\.|"/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
				<span class="hljs-keyword">if</span>(x === <span class="hljs-string">'"'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'\\"'</span>;
				<span class="hljs-keyword">return</span> x;
			}).replace(<span class="hljs-regexp">/^'|'$/g</span>, <span class="hljs-string">'"'</span>));
		}
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-string">'"'</span> + str + <span class="hljs-string">'"'</span>);
	} <span class="hljs-keyword">catch</span>(e) {
		<span class="hljs-keyword">return</span> str;
	}
};

exports.getHashDigest = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHashDigest</span>(<span class="hljs-params">buffer, hashType, digestType, maxLength</span>) </span>{
	hashType = hashType || <span class="hljs-string">"md5"</span>;
	maxLength = maxLength || <span class="hljs-number">9999</span>;
	<span class="hljs-keyword">var</span> hash = <span class="hljs-built_in">require</span>(<span class="hljs-string">"crypto"</span>).createHash(hashType);
	hash.update(buffer);
	<span class="hljs-keyword">if</span> (digestType === <span class="hljs-string">"base26"</span> || digestType === <span class="hljs-string">"base32"</span> || digestType === <span class="hljs-string">"base36"</span> ||
	    digestType === <span class="hljs-string">"base49"</span> || digestType === <span class="hljs-string">"base52"</span> || digestType === <span class="hljs-string">"base58"</span> ||
	    digestType === <span class="hljs-string">"base62"</span> || digestType === <span class="hljs-string">"base64"</span>) {
		<span class="hljs-keyword">return</span> encodeBufferToBase(hash.digest(), digestType.substr(<span class="hljs-number">4</span>)).substr(<span class="hljs-number">0</span>, maxLength);
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-keyword">return</span> hash.digest(digestType || <span class="hljs-string">"hex"</span>).substr(<span class="hljs-number">0</span>, maxLength);
	}
};

exports.interpolateName = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">interpolateName</span>(<span class="hljs-params">loaderContext, name, options</span>) </span>{
	<span class="hljs-keyword">var</span> filename;
	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> name === <span class="hljs-string">"function"</span>) {
		filename = name(loaderContext.resourcePath);
	} <span class="hljs-keyword">else</span> {
		filename = name || <span class="hljs-string">"[hash].[ext]"</span>;
	}
	<span class="hljs-keyword">var</span> context = options.context;
	<span class="hljs-keyword">var</span> content = options.content;
	<span class="hljs-keyword">var</span> regExp = options.regExp;
	<span class="hljs-keyword">var</span> ext = <span class="hljs-string">"bin"</span>;
	<span class="hljs-keyword">var</span> basename = <span class="hljs-string">"file"</span>;
	<span class="hljs-keyword">var</span> directory = <span class="hljs-string">""</span>;
	<span class="hljs-keyword">var</span> folder = <span class="hljs-string">""</span>;
	<span class="hljs-keyword">if</span>(loaderContext.resourcePath) {
		<span class="hljs-keyword">var</span> resourcePath = loaderContext.resourcePath;
		<span class="hljs-keyword">var</span> idx = resourcePath.lastIndexOf(<span class="hljs-string">"."</span>);
		<span class="hljs-keyword">var</span> i = resourcePath.lastIndexOf(<span class="hljs-string">"\\"</span>);
		<span class="hljs-keyword">var</span> j = resourcePath.lastIndexOf(<span class="hljs-string">"/"</span>);
		<span class="hljs-keyword">var</span> p = i &lt; <span class="hljs-number">0</span> ? j : j &lt; <span class="hljs-number">0</span> ? i : i &lt; j ? i : j;
		<span class="hljs-keyword">if</span>(idx &gt;= <span class="hljs-number">0</span>) {
			ext = resourcePath.substr(idx+<span class="hljs-number">1</span>);
			resourcePath = resourcePath.substr(<span class="hljs-number">0</span>, idx);
		}
		<span class="hljs-keyword">if</span>(p &gt;= <span class="hljs-number">0</span>) {
			basename = resourcePath.substr(p+<span class="hljs-number">1</span>);
			resourcePath = resourcePath.substr(<span class="hljs-number">0</span>, p+<span class="hljs-number">1</span>);
		}
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> context !== <span class="hljs-string">'undefined'</span>) {
			directory = path.relative(context, resourcePath + <span class="hljs-string">"_"</span>).replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">"/"</span>).replace(<span class="hljs-regexp">/\.\.(\/)?/g</span>, <span class="hljs-string">"_$1"</span>);
			directory = directory.substr(<span class="hljs-number">0</span>, directory.length<span class="hljs-number">-1</span>);
		}
		<span class="hljs-keyword">else</span> {
			directory = resourcePath.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">"/"</span>).replace(<span class="hljs-regexp">/\.\.(\/)?/g</span>, <span class="hljs-string">"_$1"</span>);
		}
		<span class="hljs-keyword">if</span> (directory.length === <span class="hljs-number">1</span>) {
			directory = <span class="hljs-string">""</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (directory.length &gt; <span class="hljs-number">1</span>) {
			folder = path.basename(directory);
		}
	}
	<span class="hljs-keyword">var</span> url = filename;
	<span class="hljs-keyword">if</span>(content) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Match hash template</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		url = url.replace(<span class="hljs-regexp">/\[(?:(\w+):)?hash(?::([a-z]+\d*))?(?::(\d+))?\]/ig</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> exports.getHashDigest(content, <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>], <span class="hljs-built_in">arguments</span>[<span class="hljs-number">2</span>], <span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">3</span>], <span class="hljs-number">10</span>));
		}).replace(<span class="hljs-regexp">/\[emoji(?::(\d+))?\]/ig</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> encodeStringToEmoji(content, <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);
		});
	}
	url = url.replace(<span class="hljs-regexp">/\[ext\]/ig</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> ext;
	}).replace(<span class="hljs-regexp">/\[name\]/ig</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> basename;
	}).replace(<span class="hljs-regexp">/\[path\]/ig</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> directory;
	}).replace(<span class="hljs-regexp">/\[folder\]/ig</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">return</span> folder;
	});
	<span class="hljs-keyword">if</span>(regExp &amp;&amp; loaderContext.resourcePath) {
		<span class="hljs-keyword">var</span> re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(regExp);
		<span class="hljs-keyword">var</span> match = loaderContext.resourcePath.match(re);
		<span class="hljs-keyword">if</span>(match) {
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; match.length; i++) {
				<span class="hljs-keyword">var</span> re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"\\["</span> + i + <span class="hljs-string">"\\]"</span>, <span class="hljs-string">"ig"</span>);
				url = url.replace(re, match[i]);
			}
		}
	}
	<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> loaderContext.options === <span class="hljs-string">"object"</span> &amp;&amp; <span class="hljs-keyword">typeof</span> loaderContext.options.customInterpolateName === <span class="hljs-string">"function"</span>) {
		url = loaderContext.options.customInterpolateName.call(loaderContext, url, name, options);
	}
	<span class="hljs-keyword">return</span> url;
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
